angular.module("heatMap",["ui.router","ngMaterial"]).config(["$urlRouterProvider","$locationProvider","$mdThemingProvider",function(a,b,c){a.otherwise("/"),b.html5Mode(!0),c.theme("default").primaryPalette("blue").accentPalette("orange").warnPalette("red"),c.enableBrowserColor({theme:"default"})}]),angular.module("heatMap").controller("MainCtrl",["$scope","$http","$state","WebService",function(a,b,c,d){var e=this;c.go("main"),e.valProp="Site Incident Heat Severity Map (lv12)",e.axisLabels={yAxis:["Sun","Mon","Tue","Wed","Thur","Fri","Sat"],xAxis:["1a","2a","3a","4a","5a","6a","7a","8a","9a","10a","11a","12p","1p","2p","3p","4p","5p","6p","7p","8p","9p","10p","11p","12a"]},d.getHeatmapData(!1).then(function(a){a.error||(e.hmData=a)}),e.axisLabelsOther={yAxis:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],xAxis:["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24"]},d.getHeatmapData(!0).then(function(a){a.error||(e.hmDataOther=a)})}]),angular.module("heatMap").directive("rawHeatmap",[function(){return{restrict:"AE",transclude:!0,scope:{hmData:"=",axisLabels:"=",valueProp:"="},templateUrl:"app/directives/rawHeatmapTemplate.html",link:function(a,b,c){function d(a){var b;return b=a>=680?9:parseInt(a/68)}function e(b){var c=a.axisLabels.xAxis.length;Array.apply(null,{length:c}).map(Number.call,Number);if(b&&b.length){b.forEach(function(b,c){var e=b.data[a.valueProp][0].value;a.hmDataSource.hasOwnProperty(b.index.dowId)||(a.hmDataSource[b.index.dowId]={rowLabel:a.axisLabels.yAxis[b.index.dowId-1],data:[]});var g=d(e);a.hmDataSource[b.index.dowId].data.push({hour:b.index.hourId,value:e,xLabel:a.axisLabels.xAxis[b.index.hourId],color:f[g],colorIndex:g})});for(var e in a.hmDataSource){var h=[],i=a.hmDataSource[e].data.length,j=0;a.hmDataSource[e].data=a.hmDataSource[e].data.sort(function(a,b){return a.hour-b.hour});for(var k=0;k<c;k++)j<i&&k===a.hmDataSource[e].data[j].hour?(a.hmDataSource[e].data[j].id=g,h.push(a.hmDataSource[e].data[j]),g++,j++):(h.push({color:f[0],hour:k,value:0,xLabel:a.axisLabels.xAxis[k],colorIndex:0,id:g}),g++);a.hmDataSource[e].data=h}}}a.severity=0,a.hmDataSource={};var f=["#01579B","#006064","#004D40","#1B5E20","#33691E","#827717","#F57F17","#FF6F00","#E65100","#B71C1C"],g=0;window.innerWidth<=884?(a.skip=!0,a.xLabelWidth="82px"):(a.skip=!1,a.xLabelWidth="88px"),a.showPopover=function(b,c){a.style={left:b.pageX-40+"px",top:b.pageY-40+"px"},a.showWhich=c.id},a.hidePopover=function(b){a.showWhich=null},a.$watch("hmData",function(){e(a.hmData)})}}}]),angular.module("heatMap").config(["$stateProvider",function(a){a.state("main",{url:"/",templateUrl:"app/views/mainView.html",controller:"MainCtrl",controllerAs:"vm"})}]),angular.module("heatMap").factory("WebService",["$http","$q",function(a,b){function c(c){var d=b.defer();return a.get("http://localhost:3000/api/getheatmapdata/"+c).success(function(a,b,c,e){!a.error&&a.data&&a.data.result?d.resolve(a.data.result):d.resolve(a)}).error(function(a,b,c,e){console.log("error",a),d.resolve(a)}),d.promise}return{getHeatmapData:c}}]);